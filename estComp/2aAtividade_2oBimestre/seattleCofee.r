# 1. Importando os dados

library(readxl)

Seattle_Coffee <- read_excel("C:/#Dev/engSoftwareUniville/estComp/2aAtividade_2oBimestre/Seattle Coffee.xlsx")
View(Seattle_Coffee)

Seattle_Coffee

# 2. Criando fatores

cafes <- factor(Seattle_Coffee$Cafe)

cafesgl <- gl(7,1, 49, labels = c(cafes))
cidadesgl <- gl(7, 7, 49, labels = c("novayork", "sidney", "seattle", "singapore", "tokyo", "paris", "orlando"))
#cidadesgl <- gl(7,7, label=c(paste("Cidade", 1:7, sep="")))
#cafesgl <- rep(paste("Cafe", 1:7, sep=""), 7)
dados <- c(87.467,
68.781,
142.235,
99.845,
84.501,
74.069,
76.587,
55.446,
83.289,
133.545,
105.151,
96.418,
83.740,
62.278,
71.250,
99.526,
99.064,
114.119,
91.382,
57.799,
65.774,
71.895,
111.142,
85.936,
83.922,
83.261,
100.042,
102.104,
79.270,
99.367,
124.137,
137.280,
84.019,
59.356,
69.725,
68.703,
114.340,
79.813,
79.842,
92.233,
47.635,
38.722,
70.860,
114.382,
93.264,
109.462,
85.250,
68.629,
87.541
)

#dados <- gl(49, 1, 49, labels = c(novayork, sidney, seattle, singapore, tokyo, paris, orlando))

#3 Criando um data frame
tabela <- data.frame(Cidadesdata = cidadesgl, cafesdata = factor(cafesgl), dadosdata = dados)

resultado <- aov(dadosdata ~ cafesdata + Cidadesdata, tabela)

anova(resultado)

#teste tuckey 

testetuvkey <- TukeyHSD(resultado, "cafesdata")

plot(testetuvkey, cex=0.0001)



#preÃ§o por cidade

library(readxl)

precoUnitario <- read_excel("C:/#Dev/engSoftwareUniville/estComp/2aAtividade_2oBimestre/Starbucks_coffee_aov_cities.xlsx")

#View(precoUnitario)

cafesgl <- gl(8,1, 512, labels = c(precoUnitario$Cafe))


cidadesgl <- gl(64, 8, 512, labels = c(colnames(precoUnitario[,2:65])))


#dados <- gl(8, 1, 512, labels = c(precoUnitario$((colnames(precoUnitario[,2:65])))))


dados <- c(
2.07,2.94,2.9,2.32,1.39,
2.51,
5.3,
4.44,
3.83,
3.97,
3.62,
2.4,
1.03,
2.43,
4.63,
4.58,
2.8,
3.33,
3.16,
3.83,
1.53,
2.93,
4.53,
5.96,
2.16,
2.55,
2.2,
2.58,
1.64,
2.72,
4.71,
4.28,
3.21,
2.41,
3.66,
4.09,
1.4,
2.2,
4.29,
6.2,
3.94,
3.64,
3.1,
2.92,
2.35,
2.6,
4.15,
5.22,
2.86,
2.29,
2.21,
3.96,
1.24,
2.53,
3.7,
5.61,
2.2,
2.97,
3.29,
2.6,
2.44,
2.26,
5.09,
4.44,
3.71,
3.43,
2.22,
2.13,
1.68,
2.07,
3.18,
4.1,
3.9,
2.81,
2.17,
3.51,
2.18,
2.04,
5.92,
6.97,
3.99,
2.79,
3.26,
4.55,
1.08,
2.3,
5.5,
5.35,
3.74,
2.88,
3.37,
3.81,
1.68,
2.98,
3.35,
4.77,
3.49,
2.88,
3.34,
4.79,
2.71,
2.2,
3.57,
5.03,
2.08,
3.14,
3.69,
3.97,
2.25,
2.4,
4.75,
5.15,
2.22,
3.34,
3.67,
4.31,
1.47,
2.15,
4.54,
5.64,
2.95,
3.34,
3.55,
3.24,
2.18,
2.5,
5.89,
5.43,
3.51,
3.62,
3.14,
4.13,
2.67,
2.57,
4.36,
5.59,
2.21,
2.6,
3.21,
4.29,
2.75,
2.21,
5.15,
6.28,
2.01,
3.51,
3.11,
4.15,
2.15,
2.05,
3.11,
5.34,
2.58,
2.79,
2.62,
2.3,
1.75,
2.71,
5.25,
5.04,
2.36,
2.83,
3.82,
2.38,
1.23,
2.09,
4.26,
6.79,
3.21,
2.87,
2.82,
3.32,
2.77,
2.28,
4.97,
6.32,
2.98,
2.32,
2.33,
2.02,
1.09,
2.61,
3.56,
4.08,
2.37,
2.03,
3.37,
3.01,
1.31,
2.04,
5.16,
4.99,
3.84,
3.76,
2.54,
4.71,
1.71,
2.48,
5.97,
5.84,
3.06,
3.62,
2.68,
4.27,
2.31,
2,
3.65,
4.58,
3.43,
2.33,
3.37,
2.71,
1.13,
2.28,
3.06,
6.09,
3.08,
2.73,
3.99,
2.9,
1.76,
2.9,
4.38,
4.19,
2.58,
2.52,
2.66,
2.33,
1.34,
2.23,
5.38,
5.6,
3.91,
3.43,
2.14,
4.26,
2.76,
2.41,
5.07,
4.57,
2.6,
3.5,
3.04,
4.81,
1.04,
2.02,
3.18,
5.54,
3.22,
3.41,
3.87,
3.99,
2.25,
2.37,
5.89,
5.54,
2.84,
2.46,
2.07,
4.09,
2.21,
2.82,
5.63,
6.28,
2.79,
2.1,
2.26,
3.07,
2.23,
2.53,
5.96,
6.95,
3.28,
3.43,
2.25,
2.61,
2.05,
2.13,
4.5,
4.54,
2.41,
2.79,
3.19,
3.53,
2.38,
2.72,
5.04,
4.16,
3.1,
3.69,
3.96,
4.73,
1.3,
2.28,
5.71,
6.01,
3.85,
3.85,
2.32,
2.85,
2.03,
2.23,
3.84,
5.84,
2.92,
3.15,
3.54,
3.05,
2.58,
2.22,
3.79,
5.85,
3.95,
2.33,
2.86,
4.68,
2.03,
2.82,
3.04,
6.74,
3.03,
3.98,
2.69,
4.26,
2.46,
2.57,
4.86,
4.92,
3.94,
3.35,
3.25,
2.38,
1.3,
2.31,
3.3,
6.12,
3.82,
2.75,
3.44,
4.89,
2.06,
2.62,
4.69,
5.31,
2.14,
3.47,
3.5,
3.8,
1.37,
2.08,
4.16,
4.35,
3.11,
2.52,
3.33,
3.49,
2.16,
2.22,
3.1,
5.29,
3.64,
2.82,
2.37,
2.51,
2.97,
2.73,
4.05,
4.73,
2.37,
3.61,
2.56,
4.66,
2.34,
2.3,
4.83,
6.58,
3.78,
2.69,
3.05,
3.18,
1.08,
2.84,
4.48,
5.27,
2.88,
2.95,
2.44,
4.57,
1.85,
2.42,
4.84,
5.47,
2.27,
2.48,
2.1,
3.53,
1.3,
2.36,
5.83,
6.44,
2.59,
3.27,
3.65,
3.85,
1.59,
2.51,
4.16,
6.19,
2.01,
2.99,
3.45,
2.82,
1.11,
2.61,
5.8,
6.5,
3.25,
2.04,
2.55,
3.2,
1.91,
2.15,
3.09,
4.35,
2.84,
2.81,
2.39,
2.16,
2.41,
2.28,
4.12,
5.83,
2.18,
2.45,
2.67,
2.12,
2.08,
2.53,
3.51,
6.33,
2.69,
3.54,
3.75,
2.61,
2.29,
2.33,
5.94,
4.67,
2.49,
3.7,
3.58,
4.38,
2.8,
2.82,
4.51,
5.17,
3.05,
2.22,
3.37,
2.74,
1.82,
2.05,
4.44,
4.04,
2.92,
3.12,
3.54,
3.19,
1.28,
2.29,
5.14,
5.18,
2.27,
3.2,
2.15,
3.01,
2.29,
2.38,
4.48,
4.13,
2.28,
3.09,
3.53,
4.24,
2.99,
2.26,
5.9,
6.08,
3.79,
2.3,
3.01,
2.67,
1.12,
2.36,
3.68,
5.55,
2.5,
2.08,
2.04,
3.33,
1.77,
2.86,
5.85,
4.2,
3.79,
2.28,
3.23,
4.85,
2.43,
2.79,
5.97,
6.79
)



tabela <- data.frame(Cidades = cidadesgl, Cafes = factor(cafesgl), Dados = dados)

AnaliseOfVar <- aov(Dados ~ Cafes + Cidades, data = tabela)

Anova <- anova(AnaliseOfVar)

#TuckeyHSD

Tuckey <- TukeyHSD(AnaliseOfVar)


plot(Tuckey)
